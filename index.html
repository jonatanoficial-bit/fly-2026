<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <title>FlySim 2026</title>

  <!-- Leaflet CSS (MAPA REAL) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- Seu CSS (se existir) -->
  <link rel="stylesheet" href="css/style.css" />

  <style>
    /* Base AAA simples caso seu CSS não carregue */
    :root{
      --bg:#070b14;
      --panel:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --radius:16px;
    }
    html,body{height:100%; margin:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;}
    #app{height:100%; display:flex; flex-direction:column;}
    header{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px; border-bottom:1px solid var(--border);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      backdrop-filter: blur(10px);
    }
    header .brand{display:flex; gap:10px; align-items:center; font-weight:900;}
    header .brand .dot{width:10px; height:10px; border-radius:999px; background:#22c55e; box-shadow:0 0 0 6px rgba(34,197,94,.15);}
    header .actions{display:flex; gap:10px; align-items:center;}
    button{
      border:1px solid var(--border);
      background:rgba(255,255,255,.08);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      font-weight:900;
      cursor:pointer;
    }
    button:hover{filter:brightness(1.08);}
    button.ghost{background:transparent;}
    main{flex:1; display:flex; min-height:0;}
    #mapWrap{position:relative; flex:1; min-height:0;}
    #map{height:100%; width:100%; background:#0b1220;}
    #mapLoading{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,.45);
      z-index:999;
      backdrop-filter: blur(6px);
    }
    #mapLoading .card{
      width:min(420px, 92vw);
      padding:16px;
      border-radius:var(--radius);
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      box-shadow:var(--shadow);
      text-align:center;
    }
    #mapLoading .title{font-weight:1000; font-size:16px;}
    #mapLoading .sub{margin-top:6px; color:var(--muted); font-size:13px;}
    #panel{
      width:min(420px, 92vw);
      max-width:460px;
      border-left:1px solid var(--border);
      background:rgba(255,255,255,.04);
      backdrop-filter: blur(10px);
      display:flex;
      flex-direction:column;
      min-height:0;
    }
    #panel.hidden{display:none;}
    #tabs{display:flex; gap:8px; padding:10px; border-bottom:1px solid var(--border); flex-wrap:wrap;}
    .tab{padding:8px 10px; border-radius:999px; border:1px solid var(--border); background:rgba(255,255,255,.06); font-weight:900; font-size:13px;}
    .tab.active{background:rgba(34,197,94,.18); border-color:rgba(34,197,94,.35);}
    #panelBody{padding:12px; overflow:auto; min-height:0;}
    .card2{
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      border-radius:var(--radius);
      padding:12px;
      box-shadow:0 10px 22px rgba(0,0,0,.25);
      margin-bottom:10px;
    }
    .row{display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;}
    .muted{color:var(--muted);}
    .kpi{font-weight:1000;}
    .small{font-size:12px;}
    .hr{height:1px; background:var(--border); margin:10px 0;}
    @media (max-width: 900px){
      main{flex-direction:column;}
      #panel{width:100%; max-width:none; border-left:none; border-top:1px solid var(--border); height:44vh;}
    }
  </style>
</head>

<body>
  <div id="app">
    <header>
      <div class="brand">
        <span class="dot"></span>
        <span>FlySim 2026</span>
      </div>
      <div class="actions">
        <button id="openPanelBtn" type="button">Painel</button>
        <button id="tutorialBtn" class="ghost" type="button">Tutorial</button>
      </div>
    </header>

    <main>
      <section id="mapWrap">
        <div id="map"></div>

        <div id="mapLoading">
          <div class="card">
            <div class="title">Carregando mapa e dados…</div>
            <div class="sub">Se estiver offline, o jogo entra em modo mapa simples automaticamente.</div>
          </div>
        </div>
      </section>

      <aside id="panel" class="hidden">
        <div id="tabs">
          <button class="tab active" data-tab="home" type="button">Painel</button>
          <button class="tab" data-tab="fleet" type="button">Frota</button>
          <button class="tab" data-tab="routes" type="button">Rotas</button>
          <button class="tab" data-tab="flights" type="button">Voos</button>
          <button class="tab" data-tab="staff" type="button">Equipe</button>
          <button class="tab" data-tab="ledger" type="button">Caixa</button>
        </div>
        <div id="panelBody">
          <div class="card2">
            <div class="row">
              <div>
                <div class="muted small">Status</div>
                <div class="kpi" id="statusText">Inicializando…</div>
              </div>
              <div style="text-align:right;">
                <div class="muted small">Dia/Hora</div>
                <div class="kpi" id="clockText">—</div>
              </div>
            </div>
            <div class="hr"></div>
            <div class="row">
              <div>
                <div class="muted small">Caixa</div>
                <div class="kpi" id="cashText">—</div>
              </div>
              <div style="text-align:right;">
                <div class="muted small">Reputação</div>
                <div class="kpi" id="repText">—</div>
              </div>
            </div>
          </div>

          <div class="card2">
            <div class="kpi">Últimos lançamentos</div>
            <div class="muted small" id="ledgerMini">—</div>
          </div>

          <div class="card2">
            <div class="kpi">Ações rápidas</div>
            <div class="row" style="margin-top:10px;">
              <button id="btnBuyPlane" type="button">Comprar aeronave</button>
              <button id="btnCreateRoute" type="button">Criar rota</button>
              <button id="btnHireStaff" type="button">Contratar</button>
            </div>
            <div class="muted small" style="margin-top:8px;">Dica: você também pode clicar na rota/avião no mapa.</div>
          </div>

        </div>
      </aside>
    </main>
  </div>

  <!-- Leaflet JS (MAPA REAL) — deve vir ANTES do map.js -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- Seus módulos do jogo (ajuste os caminhos se no seu projeto forem diferentes) -->
  <script src="js/data.js"></script>
  <script src="js/store.js"></script>
  <script src="js/economy.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/game.js"></script>
  <script src="js/map.js"></script>
  <script src="js/bootstrap.js"></script>

  <script>
    // UI básica do botão "Painel" e "Tutorial" caso seu ui.js não trate isso
    (function(){
      const panel = document.getElementById("panel");
      const openBtn = document.getElementById("openPanelBtn");
      const tutBtn = document.getElementById("tutorialBtn");

      openBtn?.addEventListener("click", () => {
        panel.classList.toggle("hidden");
        if (window.UIModule?.openPanel) window.UIModule.openPanel();
      });

      tutBtn?.addEventListener("click", () => {
        if (window.UIModule?.startTutorial) window.UIModule.startTutorial(true);
        else alert("Tutorial: seu ui.js precisa ter UIModule.startTutorial().");
      });

      // Botões rápidos (se seu ui.js tiver handlers)
      document.getElementById("btnBuyPlane")?.addEventListener("click", () => {
        panel.classList.remove("hidden");
        window.UIModule?.openPanel?.();
        window.UIModule?.selectTab?.("fleet");
      });
      document.getElementById("btnCreateRoute")?.addEventListener("click", () => {
        panel.classList.remove("hidden");
        window.UIModule?.openPanel?.();
        window.UIModule?.selectTab?.("routes");
      });
      document.getElementById("btnHireStaff")?.addEventListener("click", () => {
        panel.classList.remove("hidden");
        window.UIModule?.openPanel?.();
        window.UIModule?.selectTab?.("staff");
      });
    })();
  </script>
</body>
</html>
